---

auth:
  enabled: false

architecture: standalone

podAnnotations: {}

metrics:
  enabled: true
  containerPort: 9216
  service:
    annotations:
      prometheus.io/scrape: "true"
      prometheus.io/port: "{{ .Values.metrics.service.port }}"
      prometheus.io/path: "/metrics"
    type: ClusterIP
    port: 9216
  serviceMonitor:
    enabled: true
    namespace: monitoring
    additionalLabels:
      # https://github.com/prometheus-community/helm-charts/tree/main/charts/kube-prometheus-stack#prometheusioscrape
      release: prometheus-stack
  prometheusRule:
    enabled: true
    namespace: monitoring
    additionalLabels:
      app: mongodb
      release: prometheus-stack
    rules:
      - name: mongodb
        rules:
          - alert: HighActiveConnectionCount
            expr: mongodb_connections{job="mongodb-metrics",state="active"} > 1000
            for: 10m
            labels:
              severity: warning
            annotations:
              message: High active connection count, check nodes for slowqueries
